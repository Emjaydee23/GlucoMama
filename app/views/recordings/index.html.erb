<div class="px-5 mx-5">
  <h2><%= current_user.first_name %>'s Review</h2>

  <%# Searchbar %>
  <div class="row justify-content-center">
    <div class="col-sm-8 my-3">
      <%= form_tag recordings_path, method: :get, class: "d-flex" do %>
        <%= label_tag "query", "Search Date:", class: "mr-2 mt-1" %>
        <%= date_field_tag :query,
              params[:query],
              class: "form-control mr-2",
              style: "width: 200px;",
              placeholder: "YYYY-MM-DD"
          %>
          <%= hidden_field_tag :patient, params[:patient] %>
        <%= submit_tag "Search", name: "", class: "btn btn-primary" %>
      <% end %>
    </div>
  </div>

  <div class="row m-0">
    <% @searches.each do |search| %>
      <div class="col-12 col-sm-6 col-md-3 mb-3">
        <div class="card">
          <% if search.reading > 5 %>
            <div>
              <h6>BM: <strong style="color:red"><%= search.reading %></strong> mmol/L</h6>
            </div>
          <% elsif search.reading >= 2 && search.reading <= 4 %>
            <h6>BM: <strong style="color:green"><%= search.reading %></strong> mmol/L</h6>
          <% elsif search.reading < 2 %>
            <h6>BM: <strong style="color:red"><%= search.reading %></strong> mmol/L</h6>
          <% end %>
          <h6>Timing: <%= search.time %></h6>
          <h6>Meal details: <%= search.ingredients %></h6>
          <%= link_to "Edit", edit_recording_path(search) %>
          <%= link_to "Delete", recording_path(search), method: :delete, data: { confirm: "Are you sure?" } %>
        </div>
      </div>
    <% end %>
  </div>

  <h1>See all Bloods</h1>
  <%= link_to "Add New BM", new_recording_path %>

  <div class="row m-0">
    <% @blood_glucose_recordings.each do |recording| %>
      <div class="col-12 col-sm-6 col-md-3 mb-3">
        <div class="card">
          <% if recording.reading > 5 %>
            <div>
              <h6>Glucose: <strong style="color:red"><%= recording.reading %></strong> mmol/L</h6>
              <h6>Date: <%= recording.date %></h6>
              <h6>Time: <%= recording.time %></h6>
              <h6>Meal details: <%= recording.ingredients %></h6>
            </div>
          <% elsif recording.reading >= 2 && recording.reading <= 4 %>
            <div>
              <h6>Glucose: <strong style="color:orange"><%= recording.reading %></strong> mmol/L</h6>
              <h6>Date: <%= recording.date %></h6>
              <h6>Time: <%= recording.time %></h6>
              <h6>Meal details: <%= recording.ingredients %></h6>
            </div>
          <% elsif recording.reading < 2 %>
            <div>
              <h6>Glucose: <strong style="color:red"><%= recording.reading %></strong> mmol/L</h6>
              <h6>Date: <%= recording.date %></h6>
              <h6>Time: <%= recording.time %></h6>
              <h6>Meal details: <%= recording.ingredients %></h6>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <%if current_user.clinician? == false %>
    <%= link_to "Back to Dashboard", dashboard_path %>
  <% else %>
    <%= link_to "Back to Dashboard", clinician_dashboard_path %>
  <% end %>
</div>
